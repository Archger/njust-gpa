<?php
$classrooms = array(
    1 => array(
        1 => "A504<br/>B309<br/> C201 C205 C207 C208 C209",
        2 => "A103 A109 A110 A112 A208 A210 A212 A301 A302  A304 A306  A307 A308  A309 A411 <br/>B101 B307 B311 B312 B314  B401<br/>C101 C102 C103  C104 C106 C107 C201 C205 C207 C209",
        3 => "A108  A404   A507<br/> B303 B401 B408 <br/>C101C201 C205 C207",
        4 => "A104  A108 A112  A203 A206  A208 A210  A211 A304  A406 A407 A411 A501 A506<br/> B307 B309 B311 B312  B401 <br/>C104 C105 C201 C205 C207 C208 C209",
        5 => "A103 A104 A108 A109 A110 A111 A202 A203 A206 A207 A208 A212 A301 A302 A307 A308 A309 A310 A311 A312 A401 A406 A407 A409 A411 A501 A502 A504 A509 A510 <br/>B306 B307 B311 B312 B314 B401 B403 B408 B410 B411 B412 B414 B508 <br/>C105 C106 C107 C108 C201 C205 C207 C208 C209"
    ),
    2 => array(
        1 => "A101 A102 A104 A202 A203 A206 A302 A403  <br/> B301 B401 <br/>C101 C102 C201 C205 C207 C208 C209",
        2 => "A101 A104 A110 A112 A202 A206 A208 A210 A212 A301 A304 A306 A307 A308 A309 A310 A403 A406 A411 A501 A502 A504<br/> B101 B301 B303 B306 B307 B309 B311 B312 B314 B401  B403<br/> C102 C103 C104 C105 C201 C205 C207 C208 C209",
        3 => "A104 A206 A301 A302 A504<br/> B101 <br/>C102 C201 C205 C208 C209",
        4 => "A104 A112 A208 A210 A212 A302 A304 A401 A404   A411 A502 A504 <br/>B101 B301 B303 B306 B307 B309 B311 B312 B314 B401  B403<br/> C101 C102 C104 C105 C106 C107 C108 C201 C205 C207 C208 C209",
        5 => "A101 A102 A103 A104 A106 A107 A108 A109 A110 A112 A202 A203 A204 A206 A208 A210 A212 A301 A302 A304 A306 A307 A308 A309 A310 A311 A401 A404 A406 A411 A501 A502 A506 A507 A508 A509 <br/>B101 B301 B303 B306 B307 B308 B309 B310 B311 B312 B314 B401 B403 B406 B408 B410 B411 B412 B414 B501 B508<br/> C102 C104 C105 C201 C205 C207 C208 C209"
    ),
    3 => array(
        1 => "A107 A108 A403 A308   A507 A510 <br/>B303 B314  B403 <br/>C201 C205 C207 C208 C209",
        2 => "A112 A202 A203 A104 A403 A206 A304 A406 A208 A407   A110 A210  A411 A501<br/> B301 B307 B309 B311 B312 B401<br/> C104 C105 C107 C108 C201 C205 C207 C208 C209",
        3 => "  A508 <br/>C201 C205 C207 C208",
        4 => "A112 A203 A406 A108 A208   A109 A502 A510 <br/>B101 B301 B307 B309  B401<br/> C101 C102 C103 C104 C105 C106 C107 C205 C207 C208 C209",
        5 => "A101 A102 A103 A104 A108 A109 A110 A111 A112 A203 A204 A206 A208 A210 A211 A212 A301 A304 A307 A308 A309 A311 A401 A403 A404 A407 A411 A501 A502 A504 A507 A508<br/> B301 B303 B306 B309 B311 B401 B403 B406 B408 B410 B411 B414 B501 B508 <br/>C104 C201 C205 C207 C208 C209"
    ),
    4 => array(
        1 => "A403  <br/> C101 C102 C103 C104 C105 C106 C107 C108 C201 C205 C207 C209",
        2 => "A112 A212 A102 A107 A302 A401 A104 A204 A403 A106 A304 A404 A107 A207 A306 A406 A108 A208 A209   A110 A210 A409 A310 A411 A502 A504<br/> B301 B303 B306 B307 B309 B311 B312 B314 B401 B406  B408 <br/>C101 C102 C104 C105 C108 C201 C205 C207 C208 C209",
        3 => "A301 A203 A302 A104 A103 A107  <br/> B301 B309<br/> C101 C102 C201 C205 C207 C208 C209",
        4 => "A104 A110 A112 A202 A206 A208 A210 A212 A301 A304 A308  A309 A401 A403 A411 A504 <br/>B101 B301 B303 B306 B307 B309 B311 B314 B401 B403 B408 <br/>C102 C104 C107 C201 C205 C207 C208 C209",
        5 => "A101 A102 A103 A104 A107 A108 A109 A110 A111 A112 A202 A203 A204 A206 A208 A209 A210 A212 A301 A302 A304 A307 A308 A309 A310 A311 A312 A401 A403 A404 A406 A407 A409 A411 A502 A504 A506 A508 A509 <br/>B101 B303 B306 B307 B308 B309 B310 B311 B312 B314 B401 B403 B406 B410 B411 B412 B414 B501 B508<br/> C102 C104 C106 C201 C205 C207 C208 C209"
    ),
    5 => array(
        1 => "A101 A104 A108 A109 A110 A302 A304 A401 A504<br/> B101 B301 B303<br/> C102 C201 C205 C207 C208 C209",
        2 => "A103 A106 A109 A110 A111 A112 A204 A208 A210 A303 A306 A311 A312 A401 A404  A407    A411 A502 A504 A510 <br/>B303 B306 B307 B308 B309 B311 B312 B403 B406 B408<br/> C205 C207 C208 C209",
        3 => "A102 A302   A401 A506 A507 <br/>B101 B401 <br/>C101 C201 C205 C207 C208 C209",
        4 => "A102 A103 A112 A207 A210 A212 A301 A303 A304 A307 A308 A403 A404  A406    A411 A502  A509<br/> B101 B301 B303 B307 B309 B311 B312 B314 B403 B408<br/> C102 C103 C104 C106 C107 C108 C201 C205 C207 C208 C209",
        5 => "A101 A102 A103 A104 A106 A107 A108 A109 A111 A112 A202 A203 A204 A206 A207 A208 A209 A210 A211 A212 A301 A302 A303 A304 A306 A307 A308 A309 A310 A311 A312 A401 A403 A404 A406 A407 A409 A411 A501 A502 A504 A507 A508 A509<br/> B101 B301 B303 B307 B308 B309 B310 B311 B312 B314 B401 B403 B406 B408 B410 B411 B412 B414 B501 B508<br/> C101 C102 C103 C104 C105 C106 C107 C108 C201 C205 C207 C208 C209"
    ),);

$tip = "<br />自习教室有:<br />";
$day = array(
    0 => "日",
    1 => "一",
    2 => "二",
    3 => "三",
    4 => "四",
    5 => "五",
    6 => "六"
);

function IsWeekend($wday) {
    if ($wday == 6 || $wday == 0)
        return 1;
    return 0;
}

//获得系统时间
$time = getdate();
$hour = $time['hours'];
$min = $time['minutes'];
$wday = $time['wday'];
//print_r($time);
//获得get传入的时间
if ($_GET['hour'])
    $hour = $_GET['hour'];
if ($_GET['min'])
    $min = $_GET['min'];
if ($_GET['wday'])
    $wday = $_GET['wday'];

$isWeekend = IsWeekend($wday);

if (!$isWeekend) {
    $class = array(
        0 => array(0 => "已经夜深人静呐", 1 => "现在可以去一工的通宵教室，学霸威武！"),
        1 => array(0 => "现在是清晨", 1 => "你可以去一二三四工的任意一间教室，还可以在日光下晨读！"),
        2 => array(0 => "星期" . $day[$wday] . "第一大节", 1 => $tip . $classrooms[$wday][1]),
        3 => array(0 => "星期" . $day[$wday] . "第二大节", 1 => $tip . $classrooms[$wday][2]),
        4 => array(0 => "星期" . $day[$wday] . "午休时间", 1 => "一二三四工的任意一间教室，主页菌建议午睡哦！"),
        5 => array(0 => "星期" . $day[$wday] . "第三大节", 1 => $tip . $classrooms[$wday][3]),
        6 => array(0 => "星期" . $day[$wday] . "第四大节", 1 => $tip . $classrooms[$wday][4]),
        7 => array(0 => "星期" . $day[$wday] . "第五大节", 1 => $tip . $classrooms[$wday][5]),
        8 => array(0 => "晚自习时间", 1 => "一、二、三、四工的任意一间教室，多看一会书再回宿舍！同时鄙视占教室开会的！"),
        9 => array(0 => "晚自习的最后阶段", 1 => "一、四工的任意一间教室，学霸要早点休息噢，明天再战不迟！")
    );

    if ($hour < 6) {
        $level = 0;
    } else if ($hour < 7 || ($hour == 7 && $min <= 30)) {
        $level = 1;
    } else if ($hour < 10 || ($hour == 10 && $min <= 25)) {
        $level = 2;
    } else if ($hour < 12 || ($hour == 12 && $min <= 15)) {
        $level = 3;
    } else if ($hour < 13 || ($hour == 13 && $min <= 30)) {
        $level = 4; //午休
    } else if ($hour < 15 || ($hour == 15 && $min <= 35)) {
        $level = 5;
    } else if ($hour < 18 || ($hour == 18 && $min <= 15)) {
        $level = 6;
    } else if ($hour < 21 || ($hour == 21 && $min <= 25)) {
        $level = 7;
    } else if ($hour <= 22) {
        $level = 8;
    } else if ($hour == 22 && $min <= 30) {
        $level = 9;
    } else {
        $level = 0;
    }
}
?>

<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>南理工自习教室推荐</title>
    </head>
    <body>
        <h2>梦想从自习室开始</h2>
        <hr />
        <?php
        echo "查询时间：星期" . $day[$wday] . " " . $hour . ":" . $min . "<hr />";

        if ($isWeekend)
            echo "周末啦，还来上自习，真不错，啧啧！<br />教室当然随你挑啦！主页菌最喜欢四工朝南的教室，阳光很好噢！";
        else
            echo $class[$level][0] . "<br />" . $class[$level][1];
        ?>
        <hr />
        <table border=1>
            <tr><td>更多查询</td><td>星期一</td><td>星期二</td><td>星期三</td><td>星期四</td><td>星期五</td></tr>
            <tr><td>第一大节</td>
                <td><a href=classroom.php?wday=1&&hour=9&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=2&&hour=9&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=3&&hour=9&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=4&&hour=9&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=5&&hour=9&&min=01>查询</a></td>
            </tr>
            <tr>
                <td>第二大节</td>
                <td><a href=classroom.php?wday=1&&hour=11&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=2&&hour=11&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=3&&hour=11&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=4&&hour=11&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=5&&hour=11&&min=01>查询</a></td>
            </tr>
            <tr>
                <td>第三大节</td>
                <td><a href=classroom.php?wday=1&&hour=15&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=2&&hour=15&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=3&&hour=15&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=4&&hour=15&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=5&&hour=15&&min=01>查询</a></td>
            </tr><tr>
                <td>第四大节</td>
                <td><a href=classroom.php?wday=1&&hour=17&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=2&&hour=17&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=3&&hour=17&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=4&&hour=17&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=5&&hour=17&&min=01>查询</a></td>
            </tr><tr>
                <td>第五大节</td>
                <td><a href=classroom.php?wday=1&&hour=19&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=2&&hour=19&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=3&&hour=19&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=4&&hour=19&&min=01>查询</a></td>
                <td><a href=classroom.php?wday=5&&hour=19&&min=01>查询</a></td>
            </tr>
        </table>

        <hr />
        <h3><a href=index.php>南理工本科生GPA查询系统</a> <a href=classroom_about.php>关于</a></h3>
        <h3>评教太麻烦？试试<a href=pingjiao/>南理工评教助手</a></h3>
        <?php
        require_once 'DB.php';
        require_once 'config.php';

        $db = new DB($hostname_, $username_, $password_, $database_name);
        $num = $db->plus(1, 1);
        echo '<hr />你是第' . $num . "个访问本页面的同学↖(^ω^)↗";
        ?>

    </body>
</html>
